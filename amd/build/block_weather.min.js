define ("block_weather/block_weather",["jquery","core/ajax","core/str","core/config","core/notification","core/templates"],function(a,b,c,d,e,f){var g={init:function init(b,d){c.get_strings([{key:"no_geo_location_support",component:"block_weather"},{key:"no_openweather_key",component:"block_weather"}]).done(function(c){g.weatherInfo(c,b,d);a(document).on("click",".block-weather-refresh",function(){var e=a("#weather-container");e.html("");g.weatherInfo(c,b,d)})})},weatherInfo:function weatherInfo(a,b,c){if("geolocation"in navigator){navigator.geolocation.getCurrentPosition(d,e)}else{g.weatherError(a[0])}function d(d){var e=d.coords.latitude,f=d.coords.longitude;if(1===b&&c.length){g.openWeather(a,c,e,f)}else{var h=a[1];g.weatherError(h)}}function e(a){var b="".concat(a.message);g.weatherError(b)}},weatherError:function weatherError(b){var c={weathererror:b,weathericon:M.util.image_url("unknown","block_weather"),weathervalue:"-"};f.render("block_weather/weather_info",c).then(function(b){var c=a("#weather-container");c.html(b)}).fail(e.exception)},openWeather:function openWeather(b,c,d,h){console.log(d);console.log(h);console.log(c);var i="https://api.openweathermap.org/data/2.5/weather?lat=".concat(d,"&lon=").concat(h,"&appid=").concat(c);console.log(i);fetch(i).then(function(a){return a.json()}).then(function(c){if(200===c.cod){var d={weathervalue:Math.floor(c.main.temp-273),weatherdesc:c.weather[0].description,weathericon:M.util.image_url(c.weather[0].icon,"block_weather"),weatherlocation:c.name+","+c.sys.country};f.render("block_weather/weather_info",d).then(function(b){var c=a("#weather-container");c.html(b)}).fail(e.exception)}else{var h=b[1];g.weatherError(h)}})}};return g});
//# sourceMappingURL=block_weather.min.js.map
