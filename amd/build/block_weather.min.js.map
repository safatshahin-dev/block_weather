{"version":3,"sources":["../src/block_weather.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","weather","init","enabledOption","openWeatherKey","get_strings","component","done","s","weatherInfo","document","on","console","log","navigator","geolocation","getCurrentPosition","setPosition","showError","weatherError","position","latitude","coords","longitude","length","openWeather","errorMsg","error","message","context","weathererror","weathericon","M","util","image_url","weathervalue","render","then","html","tag","fail","exception"],"mappings":"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","sourcesContent":["define(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str, mdlcfg, notification, templates) {\n        var weather = {\n            init: function(enabledOption, openWeatherKey) {\n                str.get_strings([\n                    {'key': 'no_geo_location_support', component: 'block_weather'},\n                    {'key': 'no_openweather_key', component: 'block_weather'}\n                ]).done(function(s) {\n                    weather.weatherInfo(s, enabledOption, openWeatherKey);\n                    $(document).on('click', '.block-weather-refresh', function() {\n                        console.log('came');\n                        weather.weatherInfo(s, enabledOption, openWeatherKey);\n                    });\n                });\n            },\n            weatherInfo: function(s, enabledOption, openWeatherKey) {\n                // CHECK IF BROWSER SUPPORTS GEOLOCATION\n                if ('geolocation' in navigator) {\n                    navigator.geolocation.getCurrentPosition(setPosition, showError);\n                } else {\n                    weather.weatherError(s[0]);\n                }\n\n                // SET USER'S POSITION\n                function setPosition(position) {\n                    let latitude = position.coords.latitude;\n                    let longitude = position.coords.longitude;\n                    if (enabledOption === 1 && openWeatherKey.length) {\n                        weather.openWeather(openWeatherKey, latitude, longitude);\n                    } else {\n                        var errorMsg = s[1];\n                        weather.weatherError(errorMsg);\n                    }\n                }\n\n                // SHOW ERROR WHEN THERE IS AN ISSUE WITH GEOLOCATION SERVICE\n                function showError(error) {\n                    var errorMsg = `${error.message}`;\n                    weather.weatherError(errorMsg);\n                }\n            },\n            weatherError: function(error) {\n                var context = {\n                    weathererror: error,\n                    weathericon: M.util.image_url('unknown', 'block_weather'),\n                    weathervalue: '-'\n                };\n                templates.render('block_weather/weather_info', context).then(function(html, js) {\n                    var tag = $('#weather-container');\n                    tag.html(html);\n                }).fail(notification.exception);\n            },\n            openWeather: function(openWeatherKey, latitude, longitude) {\n                console.log(latitude);\n                console.log(longitude);\n                console.log(openWeatherKey);\n                var context = {};\n                templates.render('block_weather/weather_info', context).then(function(html, js) {\n                    var tag = $('#weather-container');\n                    tag.html(html);\n                }).fail(notification.exception);\n            }\n        };\n        return weather;\n    });\n"],"file":"block_weather.min.js"}