{"version":3,"sources":["../src/block_weather.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","weather","init","enabledOption","weatherKey","get_strings","component","done","s","weatherError","weatherInfo","document","on","tag","html","tempValue","attr","tempAction","farhValue","Math","floor","parseInt","temp","tempData","navigator","geolocation","getCurrentPosition","setPosition","showError","position","latitude","coords","longitude","timestamp","length","openWeather","accuWeather","climacellWeather","errorMsg","error","message","context","weathererror","weathericon","M","util","image_url","weathervalue","weatherattr","render","then","fail","exception","api","fetch","response","json","data","cod","main","weatherdesc","description","icon","weatherlocation","name","sys","country","locationKey","Key","weatherData","WeatherText","Temperature","Metric","Value","WeatherIcon","EnglishName","AdministrativeArea","weatherCode","weather_code","value","today","Date","hour","getHours","location","locationData","weatherLocation","locality","principalSubdivision","get_string"],"mappings":"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","sourcesContent":["/**\n * Contains the logic for a weather block.\n *\n * @package     block_weather\n * @copyright   2020 A K M Safat Shahin <safatshahin@gmail.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str, mdlcfg, notification, templates) {\n        var weather = {\n            init: function(enabledOption, weatherKey) {\n                str.get_strings([\n                    {'key': 'no_geo_location_support', component: 'block_weather'},\n                    {'key': 'no_openweather_key', component: 'block_weather'},\n                    {'key': 'no_weather_provider', component: 'block_weather'},\n                    {'key': 'clear_day', component: 'block_weather'},\n                    {'key': 'clear_night', component: 'block_weather'},\n                    {'key': 'cloudy', component: 'block_weather'},\n                    {'key': 'drizzle', component: 'block_weather'},\n                    {'key': 'flurries', component: 'block_weather'},\n                    {'key': 'fog_light', component: 'block_weather'},\n                    {'key': 'fog', component: 'block_weather'},\n                    {'key': 'freezing_drizzle', component: 'block_weather'},\n                    {'key': 'freezing_rain_heavy', component: 'block_weather'},\n                    {'key': 'freezing_rain_light', component: 'block_weather'},\n                    {'key': 'freezing_rain', component: 'block_weather'},\n                    {'key': 'ice_pellets_heavy', component: 'block_weather'},\n                    {'key': 'ice_pellets_light', component: 'block_weather'},\n                    {'key': 'ice_pellets', component: 'block_weather'},\n                    {'key': 'mostly_clear_day', component: 'block_weather'},\n                    {'key': 'mostly_clear_night', component: 'block_weather'},\n                    {'key': 'mostly_cloudy', component: 'block_weather'},\n                    {'key': 'partly_cloudy_day', component: 'block_weather'},\n                    {'key': 'partly_cloudy_night', component: 'block_weather'},\n                    {'key': 'rain_heavy', component: 'block_weather'},\n                    {'key': 'rain_light', component: 'block_weather'},\n                    {'key': 'rain', component: 'block_weather'},\n                    {'key': 'snow_heavy', component: 'block_weather'},\n                    {'key': 'snow_light', component: 'block_weather'},\n                    {'key': 'snow', component: 'block_weather'},\n                    {'key': 'tstorm', component: 'block_weather'}\n                ]).done(function(s) {\n                    if (enabledOption === 0) {\n                        weather.weatherError(s[2]);\n                    } else {\n                        weather.weatherInfo(s, enabledOption, weatherKey);\n                    }\n                    // REFRESH THE WEATHER\n                    $(document).on('click', '.block-weather-refresh', function() {\n                        var tag = $('#weather-container');\n                        var html = '';\n                        tag.html(html);\n                        weather.weatherInfo(s, enabledOption, weatherKey);\n                    });\n                    // CHANGE CELSIUS TO FAHRENHEIT ON CLICK OR VICE THE OTHER WAY\n                    $(document).on('click', '.block-weather-temperature-value', function() {\n                        var tempValue = $('.block-weather-temperature-value').attr('data-value');\n                        if (tempValue !== '-') {\n                            var tempAction = $('.block-weather-temperature-value').attr('data-action');\n                            if (tempAction === 'celsius') {\n                                // CHANGE TO FAHRENHEIT\n                                var farhValue = Math.floor((parseInt(tempValue) * 9 / 5) + 32);\n                                var temp = $('.block-weather-temperature-value');\n                                var tempData = '<p>' + farhValue + '°<span>F</span></p>';\n                                $('.block-weather-temperature-value').attr('data-action', 'fahrenheit');\n                                temp.html(tempData);\n                            } else {\n                                // CHANGE TO CELSIUS\n                                var temp = $('.block-weather-temperature-value');\n                                var tempData = '<p>' + tempValue + '°<span>C</span></p>';\n                                $('.block-weather-temperature-value').attr('data-action', 'celsius');\n                                temp.html(tempData);\n                            }\n                        }\n                    });\n                });\n            },\n            weatherInfo: function(s, enabledOption, weatherKey) {\n                // CHECK IF BROWSER SUPPORTS GEOLOCATION\n                if ('geolocation' in navigator) {\n                    navigator.geolocation.getCurrentPosition(setPosition, showError);\n                } else {\n                    weather.weatherError(s[0]);\n                }\n\n                // SET USER'S POSITION\n                function setPosition(position) {\n                    let latitude = position.coords.latitude;\n                    let longitude = position.coords.longitude;\n                    let timestamp = position.timestamp;\n                    if (enabledOption === 1 && weatherKey.length) {\n                        weather.openWeather(s, weatherKey, latitude, longitude);\n                    } else if (enabledOption === 2 && weatherKey.length) {\n                        weather.accuWeather(s, weatherKey, latitude, longitude);\n                    } else if (enabledOption === 3 && weatherKey.length) {\n                        weather.climacellWeather(s, weatherKey, latitude, longitude, timestamp);\n                    } else {\n                        var errorMsg = s[1];\n                        weather.weatherError(errorMsg);\n                    }\n                }\n\n                // SHOW ERROR WHEN THERE IS AN ISSUE WITH GEOLOCATION SERVICE\n                function showError(error) {\n                    var errorMsg = `${error.message}`;\n                    weather.weatherError(errorMsg);\n                }\n            },\n            weatherError: function(error) {\n                var context = {\n                    weathererror: `<p> ${error} </p>`,\n                    weathericon: M.util.image_url('unknown', 'block_weather'),\n                    weathervalue: '-',\n                    weatherattr: '-'\n                };\n                templates.render('block_weather/weather_info', context).then(function(html, js) {\n                    var tag = $('#weather-container');\n                    tag.html(html);\n                }).fail(notification.exception);\n            },\n            openWeather: function(s, weatherKey, latitude, longitude) {\n                let api = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${weatherKey}`;\n                fetch(api)\n                    .then(function(response) {\n                        return response.json();\n                    })\n                    .then(function(data) {\n                        if (data.cod === 200) {\n                            var context = {\n                                weathervalue: Math.floor(data.main.temp - 273),\n                                weatherdesc: data.weather[0].description,\n                                weatherattr: 'celsius',\n                                weathericon: M.util.image_url(data.weather[0].icon, 'block_weather'),\n                                weatherlocation: data.name + ', ' + data.sys.country\n                            };\n                            templates.render('block_weather/weather_info', context).then(function(html, js) {\n                                var tag = $('#weather-container');\n                                tag.html(html);\n                            }).fail(notification.exception);\n                        } else {\n                            var errorMsg = s[1];\n                            weather.weatherError(errorMsg);\n                        }\n                    });\n            },\n            accuWeather: function(s, weatherKey, latitude, longitude) {\n                let locationKey = `https://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=${weatherKey}&q=${latitude}%2C${longitude}&language=en-us&details=false&toplevel=false`;\n                fetch(locationKey)\n                    .then(function(response) {\n                        return response.json();\n                    })\n                    .then(function(data) {\n                        if (data.Key.length) {\n                            let api = `https://dataservice.accuweather.com/currentconditions/v1/${data.Key}?apikey=${weatherKey}&language=en-us&details=false`;\n                            fetch(api)\n                                .then(function(response) {\n                                    return response.json();\n                                })\n                                .then(function(weatherData) {\n                                    if (weatherData[0].WeatherText.length) {\n                                        var context = {\n                                            weathervalue: Math.floor(weatherData[0].Temperature.Metric.Value),\n                                            weatherdesc: weatherData[0].WeatherText,\n                                            weatherattr: 'celsius',\n                                            weathericon: M.util.image_url(weatherData[0].WeatherIcon, 'block_weather'),\n                                            weatherlocation: data.EnglishName + ', ' + data.AdministrativeArea.EnglishName\n                                        };\n                                        templates.render('block_weather/weather_info', context).then(function(html, js) {\n                                            var tag = $('#weather-container');\n                                            tag.html(html);\n                                        }).fail(notification.exception);\n                                    } else {\n                                        var errorMsg = s[1];\n                                        weather.weatherError(errorMsg);\n                                    }\n                                });\n                        } else {\n                            var errorMsg = s[1];\n                            weather.weatherError(errorMsg);\n                        }\n                    });\n\n            },\n            climacellWeather: function(s, weatherKey, latitude, longitude, timestamp) {\n                let api = `https://api.climacell.co/v3/weather/realtime?lat=${latitude}&lon=${longitude}&unit_system=si&fields=temp%2Cweather_code&apikey=${weatherKey}`;\n                fetch(api)\n                    .then(function(response) {\n                        return response.json();\n                    })\n                    .then(function(data) {\n                        if (data.message) {\n                            var errorMsg = s[1];\n                            weather.weatherError(errorMsg);\n                        } else {\n                            var weatherCode = data.weather_code.value;\n                            if (data.weather_code.value === 'clear') {\n                                var today = new Date(timestamp);\n                                var hour = today.getHours();\n                                if (hour >= 18 || hour <= 6) {\n                                    weatherCode = data.weather_code.value + '_night';\n                                } else {\n                                    weatherCode = data.weather_code.value + '_day';\n                                }\n                            }\n                            let location = `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=en`;\n                            fetch(location)\n                                .then(function(response) {\n                                    return response.json();\n                                })\n                                .then(function(locationData) {\n                                    var weatherLocation = '';\n                                    if (locationData.locality) {\n                                        weatherLocation = locationData.locality + ', ' + locationData.principalSubdivision;\n                                    }\n                                    var context = {\n                                        weathervalue: Math.floor(data.temp.value),\n                                        weatherdesc: M.util.get_string(weatherCode, 'block_weather', 'string'),\n                                        weatherattr: 'celsius',\n                                        weathericon: M.util.image_url(weatherCode, 'block_weather'),\n                                        weatherlocation: weatherLocation\n                                    };\n                                    templates.render('block_weather/weather_info', context).then(function(html, js) {\n                                        var tag = $('#weather-container');\n                                        tag.html(html);\n                                    }).fail(notification.exception);\n                                });\n                        }\n                    });\n            }\n        };\n        return weather;\n    });\n"],"file":"block_weather.min.js"}